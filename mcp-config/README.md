# ğŸš€ ImagentX MCP ç³»ç»Ÿ

åŸºäºæˆç†Ÿå·¥å…·å’Œæ¡†æ¶æ„å»ºçš„ä¼ä¸šçº§MCPï¼ˆModel Context Protocolï¼‰ç³»ç»Ÿï¼Œä¸ºImagentXé¡¹ç›®æä¾›å®Œæ•´çš„ç›‘æ§ã€ç®¡ç†å’Œè‡ªåŠ¨åŒ–è¿ç»´èƒ½åŠ›ã€‚

## ğŸ“Š ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ImagentX      â”‚    â”‚   Prometheus    â”‚    â”‚     Grafana     â”‚
â”‚   åº”ç”¨æœåŠ¡      â”‚â—„â”€â”€â–ºâ”‚    ç›‘æ§ç³»ç»Ÿ      â”‚â—„â”€â”€â–ºâ”‚   å¯è§†åŒ–é¢æ¿    â”‚
â”‚  (å‰ç«¯+åç«¯)    â”‚    â”‚   (æŒ‡æ ‡æ”¶é›†)     â”‚    â”‚   (æ•°æ®å±•ç¤º)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â”‚                       â”‚                       â”‚
         â–¼                       â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   MCPç½‘å…³       â”‚    â”‚   MCPè°ƒåº¦å™¨     â”‚    â”‚   MCPé…ç½®ä¸­å¿ƒ   â”‚
â”‚  (æœåŠ¡ç®¡ç†)     â”‚    â”‚  (ä»»åŠ¡è°ƒåº¦)     â”‚    â”‚  (é…ç½®ç®¡ç†)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### 1. ç›‘æ§ç³»ç»Ÿ
- **Prometheus**: æŒ‡æ ‡æ”¶é›†å’Œå­˜å‚¨
- **Grafana**: æ•°æ®å¯è§†åŒ–å’Œå‘Šè­¦
- **å¥åº·æ£€æŸ¥**: è‡ªåŠ¨æœåŠ¡çŠ¶æ€ç›‘æ§

### 2. è‡ªåŠ¨åŒ–è¿ç»´
- **ä»»åŠ¡è°ƒåº¦**: å®šæ—¶å¥åº·æ£€æŸ¥ã€å¤‡ä»½æ¸…ç†
- **é…ç½®ç®¡ç†**: ç»Ÿä¸€é…ç½®ä¸­å¿ƒ
- **æœåŠ¡ç®¡ç†**: MCPç½‘å…³ç»Ÿä¸€ç®¡ç†

### 3. å¯è§†åŒ–é¢æ¿
- **å®æ—¶ç›‘æ§**: æœåŠ¡çŠ¶æ€ã€æ€§èƒ½æŒ‡æ ‡
- **å‘Šè­¦ç®¡ç†**: å¼‚å¸¸æƒ…å†µè‡ªåŠ¨å‘Šè­¦
- **è¿ç»´é¢æ¿**: ä¸€é”®æ“ä½œç•Œé¢

## ğŸš€ å¿«é€Ÿå¯åŠ¨

### 1. å¯åŠ¨å®Œæ•´MCPç³»ç»Ÿ
```bash
chmod +x mcp-config/start-mcp.sh
./mcp-config/start-mcp.sh
```

### 2. æ‰‹åŠ¨å¯åŠ¨
```bash
# åˆ›å»ºé…ç½®ç›®å½•
mkdir -p mcp-config/grafana/provisioning/{datasources,dashboards}
mkdir -p mcp-config/configs
mkdir -p mcp-config/scheduler

# å¯åŠ¨æœåŠ¡
docker-compose -f mcp-config/docker-compose.mcp.yml up -d
```

## ğŸ“Š æœåŠ¡è®¿é—®

| æœåŠ¡ | åœ°å€ | ç”¨æˆ·å/å¯†ç  | è¯´æ˜ |
|------|------|-------------|------|
| ImagentXå‰ç«¯ | http://localhost:3000 | - | ä¸»åº”ç”¨ç•Œé¢ |
| ImagentXåç«¯ | http://localhost:8088 | - | APIæœåŠ¡ |
| Prometheus | http://localhost:9090 | - | ç›‘æ§ç³»ç»Ÿ |
| Grafana | http://localhost:3001 | admin/admin123 | å¯è§†åŒ–é¢æ¿ |
| MCPç½‘å…³ | http://localhost:8080 | imagentx-mcp-key-2024 | æœåŠ¡ç®¡ç† |
| MCPé…ç½®ä¸­å¿ƒ | http://localhost:8082 | - | é…ç½®ç®¡ç† |
| RabbitMQç®¡ç† | http://localhost:15672 | guest/guest | æ¶ˆæ¯é˜Ÿåˆ—ç®¡ç† |

## ğŸ”§ ç®¡ç†å‘½ä»¤

### æŸ¥çœ‹æœåŠ¡çŠ¶æ€
```bash
docker-compose -f mcp-config/docker-compose.mcp.yml ps
```

### æŸ¥çœ‹æ—¥å¿—
```bash
# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡æ—¥å¿—
docker-compose -f mcp-config/docker-compose.mcp.yml logs -f

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—
docker-compose -f mcp-config/docker-compose.mcp.yml logs -f prometheus
```

### é‡å¯æœåŠ¡
```bash
# é‡å¯æ‰€æœ‰æœåŠ¡
docker-compose -f mcp-config/docker-compose.mcp.yml restart

# é‡å¯ç‰¹å®šæœåŠ¡
docker-compose -f mcp-config/docker-compose.mcp.yml restart grafana
```

### åœæ­¢æœåŠ¡
```bash
docker-compose -f mcp-config/docker-compose.mcp.yml down
```

## ğŸ“ˆ ç›‘æ§æŒ‡æ ‡

### åº”ç”¨æŒ‡æ ‡
- æœåŠ¡å“åº”æ—¶é—´
- è¯·æ±‚æˆåŠŸç‡
- é”™è¯¯ç‡ç»Ÿè®¡
- èµ„æºä½¿ç”¨æƒ…å†µ

### ç³»ç»ŸæŒ‡æ ‡
- CPUä½¿ç”¨ç‡
- å†…å­˜ä½¿ç”¨ç‡
- ç£ç›˜ä½¿ç”¨ç‡
- ç½‘ç»œæµé‡

### ä¸šåŠ¡æŒ‡æ ‡
- ç”¨æˆ·æ´»è·ƒåº¦
- APIè°ƒç”¨æ¬¡æ•°
- æ•°æ®åº“è¿æ¥æ•°
- æ¶ˆæ¯é˜Ÿåˆ—çŠ¶æ€

## ğŸ”„ è‡ªåŠ¨åŒ–ä»»åŠ¡

### å®šæ—¶ä»»åŠ¡
- **æ¯5åˆ†é’Ÿ**: æœåŠ¡å¥åº·æ£€æŸ¥
- **æ¯10åˆ†é’Ÿ**: æŒ‡æ ‡æ•°æ®æ”¶é›†
- **æ¯30åˆ†é’Ÿ**: MCPç½‘å…³æ£€æŸ¥
- **æ¯å¤©å‡Œæ™¨2ç‚¹**: å¤‡ä»½æ–‡ä»¶æ¸…ç†

### å‘Šè­¦è§„åˆ™
- æœåŠ¡ä¸å¯ç”¨å‘Šè­¦
- æ€§èƒ½æŒ‡æ ‡é˜ˆå€¼å‘Šè­¦
- èµ„æºä½¿ç”¨ç‡å‘Šè­¦
- é”™è¯¯ç‡å¼‚å¸¸å‘Šè­¦

## ğŸ› ï¸ è‡ªå®šä¹‰é…ç½®

### Prometheusé…ç½®
ç¼–è¾‘ `mcp-config/prometheus.yml` æ–‡ä»¶ï¼š
```yaml
scrape_configs:
  - job_name: 'custom-service'
    static_configs:
      - targets: ['your-service:port']
```

### Grafanaä»ªè¡¨æ¿
1. è®¿é—® http://localhost:3001
2. ç™»å½•: admin/admin123
3. åˆ›å»ºæ–°çš„ä»ªè¡¨æ¿
4. æ·»åŠ Prometheusæ•°æ®æº

### ä»»åŠ¡è°ƒåº¦å™¨
ç¼–è¾‘ `mcp-config/scheduler/scheduler.py` æ–‡ä»¶ï¼š
```python
# æ·»åŠ è‡ªå®šä¹‰ä»»åŠ¡
def custom_task():
    logger.info("æ‰§è¡Œè‡ªå®šä¹‰ä»»åŠ¡")

# è®¾ç½®è°ƒåº¦
schedule.every().hour.do(custom_task)
```

## ğŸ”’ å®‰å…¨é…ç½®

### APIå¯†é’¥ç®¡ç†
- MCPç½‘å…³APIå¯†é’¥: `imagentx-mcp-key-2024`
- Grafanaç®¡ç†å‘˜å¯†ç : `admin123`
- RabbitMQé»˜è®¤å¯†ç : `guest`

### ç½‘ç»œå®‰å…¨
- æ‰€æœ‰æœåŠ¡è¿è¡Œåœ¨ç‹¬ç«‹ç½‘ç»œ `mcp-network`
- ä»…æš´éœ²å¿…è¦çš„ç«¯å£
- å†…éƒ¨æœåŠ¡é—´é€šä¿¡åŠ å¯†

## ğŸ“ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æœåŠ¡å¯åŠ¨å¤±è´¥**
   ```bash
   # æ£€æŸ¥ç«¯å£å ç”¨
   lsof -i :3000,8088,9090,3001,8080
   
   # æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
   docker-compose -f mcp-config/docker-compose.mcp.yml logs
   ```

2. **ç›‘æ§æ•°æ®ä¸æ˜¾ç¤º**
   - æ£€æŸ¥Prometheusé…ç½®
   - éªŒè¯æœåŠ¡ç«¯ç‚¹å¯è®¿é—®æ€§
   - æŸ¥çœ‹Grafanaæ•°æ®æºé…ç½®

3. **ä»»åŠ¡è°ƒåº¦å™¨å¼‚å¸¸**
   ```bash
   # æŸ¥çœ‹è°ƒåº¦å™¨æ—¥å¿—
   docker logs mcp-scheduler
   
   # é‡å¯è°ƒåº¦å™¨
   docker-compose -f mcp-config/docker-compose.mcp.yml restart mcp-scheduler
   ```

### æ—¥å¿—ä½ç½®
- åº”ç”¨æ—¥å¿—: `docker logs imagentx-app`
- ç›‘æ§æ—¥å¿—: `docker logs mcp-prometheus`
- è°ƒåº¦å™¨æ—¥å¿—: `docker logs mcp-scheduler`

## ğŸ‰ æ€»ç»“

è¿™ä¸ªMCPç³»ç»Ÿä¸ºImagentXé¡¹ç›®æä¾›äº†ï¼š

âœ… **å®Œæ•´çš„ç›‘æ§èƒ½åŠ›**: Prometheus + Grafana  
âœ… **è‡ªåŠ¨åŒ–è¿ç»´**: ä»»åŠ¡è°ƒåº¦ + å¥åº·æ£€æŸ¥  
âœ… **ç»Ÿä¸€ç®¡ç†**: MCPç½‘å…³ + é…ç½®ä¸­å¿ƒ  
âœ… **å¯è§†åŒ–ç•Œé¢**: å®æ—¶ç›‘æ§ + å‘Šè­¦ç®¡ç†  
âœ… **ä½æˆæœ¬éƒ¨ç½²**: åŸºäºæˆç†Ÿå¼€æºå·¥å…·  

**æŠ•å…¥äº§å‡ºæ¯”é«˜**: ä½¿ç”¨æˆç†Ÿå·¥å…·ï¼Œå¼€å‘æˆæœ¬ä½ï¼Œè¿ç»´æ•ˆç‡æ˜¾è‘—æå‡ï¼
