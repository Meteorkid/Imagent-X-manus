# 🏠 开发阶段域名使用指南

## 📋 域名在开发阶段的价值

### 🎯 主要用途

#### 1. **模拟真实用户环境**
```bash
# 本地开发环境
http://localhost:3000          # 仅本地访问
http://127.0.0.1:3000         # 仅本地访问

# 域名访问环境（通过内网穿透）
https://imagentx.top          # 外网可访问
https://www.imagentx.top      # 外网可访问
```

#### 2. **功能测试验证**
- **Cookie和Session测试**: 验证用户登录状态
- **跨域请求测试**: 测试API调用
- **第三方服务集成**: 测试需要域名的服务
- **移动端测试**: 手机可以访问域名测试

#### 3. **团队协作演示**
- **内部演示**: 团队成员远程访问
- **客户演示**: 展示项目进展
- **远程调试**: 不在同一网络也能访问

#### 4. **配置和集成测试**
- **DNS解析测试**: 验证域名配置
- **SSL证书测试**: 测试HTTPS功能
- **CDN集成测试**: 测试静态资源加速

## 🚀 开发阶段域名使用方案

### 方案A: ngrok内网穿透（推荐）

#### 优势
- ✅ 免费使用
- ✅ 快速设置
- ✅ 支持HTTPS
- ✅ 可以自定义域名

#### 使用步骤

##### 1. 安装ngrok
```bash
# 在项目目录执行
./setup-ngrok.sh --install
```

##### 2. 注册ngrok账号
1. 访问 [ngrok官网](https://ngrok.com/)
2. 注册免费账号
3. 获取authtoken

##### 3. 配置token
```bash
./setup-ngrok.sh --config
# 输入您的ngrok authtoken
```

##### 4. 启动本地服务
```bash
# 启动生产环境配置（模拟真实部署）
./scripts/core/start.sh --production
```

##### 5. 启动内网穿透
```bash
./setup-ngrok.sh --start
# 选择要穿透的端口（通常是80或3000）
```

##### 6. 获取公网地址
ngrok会显示类似：
```
Forwarding    https://abc123.ngrok.io -> http://localhost:80
```

##### 7. 配置域名解析（可选）
- 将 `imagentx.top` 解析到ngrok提供的IP
- 或者直接使用ngrok提供的域名

### 方案B: 本地hosts文件映射

#### 优势
- ✅ 完全免费
- ✅ 无需外网
- ✅ 响应速度快

#### 使用步骤

##### 1. 修改hosts文件
```bash
# 在Mac上编辑hosts文件
sudo nano /etc/hosts

# 添加以下行
127.0.0.1 imagentx.top
127.0.0.1 www.imagentx.top
```

##### 2. 启动本地服务
```bash
./scripts/core/start.sh --production
```

##### 3. 访问域名
```
http://imagentx.top
http://www.imagentx.top
```

## 🔧 开发阶段域名配置

### 1. 环境变量配置

#### 本地开发配置
```bash
# .env.local
NEXT_PUBLIC_API_BASE_URL=http://localhost:8080/api
NEXT_PUBLIC_SITE_URL=http://localhost:3000
```

#### 域名开发配置
```bash
# .env.domain
NEXT_PUBLIC_API_BASE_URL=https://imagentx.top/api
NEXT_PUBLIC_SITE_URL=https://imagentx.top
```

### 2. 跨域配置

#### 后端CORS配置
```java
// 允许域名访问
@CrossOrigin(origins = {
    "http://localhost:3000",
    "https://imagentx.top",
    "https://www.imagentx.top"
})
```

### 3. Cookie配置

#### 前端Cookie设置
```javascript
// 设置Cookie时指定域名
document.cookie = "token=value; domain=.imagentx.top; path=/";
```

## 📊 开发阶段域名使用场景

### 场景1: 功能开发测试
```bash
# 本地开发
http://localhost:3000

# 域名测试（通过ngrok）
https://imagentx.top
```

### 场景2: 移动端测试
```bash
# 手机浏览器访问
https://imagentx.top
```

### 场景3: 团队演示
```bash
# 同事远程访问
https://imagentx.top
```

### 场景4: 第三方服务集成
```bash
# 测试需要域名的服务
- OAuth登录
- 支付接口
- 地图服务
- 统计分析
```

## 🎯 开发阶段域名使用建议

### 1. **开发流程**
- **日常开发**: 使用 `localhost:3000`
- **功能测试**: 使用 `imagentx.top`（通过ngrok）
- **集成测试**: 使用 `imagentx.top`（通过ngrok）

### 2. **测试策略**
- **单元测试**: 本地环境
- **集成测试**: 域名环境
- **端到端测试**: 域名环境

### 3. **部署策略**
- **开发环境**: 本地 + ngrok
- **测试环境**: 云服务器
- **生产环境**: 云服务器

## 🚀 立即开始使用

### 快速设置ngrok
```bash
# 1. 安装ngrok
./setup-ngrok.sh --install

# 2. 配置token（需要先注册ngrok账号）
./setup-ngrok.sh --config

# 3. 启动本地服务
./scripts/core/start.sh --production

# 4. 启动内网穿透
./setup-ngrok.sh --start
```

### 验证域名访问
```bash
# 获取ngrok提供的公网地址
# 在浏览器中访问该地址
# 验证功能是否正常
```

## 💡 总结

### 域名在开发阶段的价值
1. **模拟真实环境**: 更接近用户实际使用场景
2. **功能验证**: 测试域名相关的功能
3. **团队协作**: 便于演示和远程访问
4. **集成测试**: 测试第三方服务集成

### 推荐使用方式
- **日常开发**: 继续使用 `localhost`
- **功能测试**: 使用 `imagentx.top`（通过ngrok）
- **正式部署**: 使用云服务器

**域名在开发阶段主要用于功能验证和团队协作，让您能够更好地模拟真实用户的使用环境！** 🎯
