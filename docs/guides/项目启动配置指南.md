# Imagent X 项目启动配置指南

## 🎯 项目概述

Imagent X 是一个智能AI助手平台，包含以下组件：
- **后端服务**：Spring Boot + PostgreSQL + RabbitMQ
- **前端服务**：Next.js + React + TypeScript
- **数据库**：PostgreSQL 15 + pgvector扩展
- **消息队列**：RabbitMQ

## ✅ 当前状态

### 已成功启动的服务
- ✅ **后端API服务**：http://localhost:8088
- ✅ **前端Web服务**：http://localhost:3000
- ✅ **PostgreSQL数据库**：localhost:5432
- ✅ **健康检查**：http://localhost:8088/api/health

## 🚀 快速启动步骤

### 1. 环境准备

```bash
# 检查Java版本（需要Java 17+）
java -version

# 设置JAVA_HOME（如果未设置）
export JAVA_HOME=/opt/homebrew/Cellar/openjdk/24.0.2/libexec/openjdk.jdk/Contents/Home

# 检查Node.js版本（需要Node.js 18+）
node --version
npm --version
```

### 2. 数据库配置

```bash
# 启动PostgreSQL服务
brew services start postgresql@15

# 创建数据库（如果不存在）
createdb imagentx

# 测试数据库连接
psql -h localhost -U postgres -d imagentx -c "SELECT version();"
```

### 3. 启动后端服务

```bash
cd ImagentX
export JAVA_HOME=/opt/homebrew/Cellar/openjdk/24.0.2/libexec/openjdk.jdk/Contents/Home
mvn spring-boot:run -DskipTests
```

### 4. 启动前端服务

```bash
cd imagentx-frontend-plus
npm install --legacy-peer-deps
npm run dev
```

## 🔧 配置说明

### 环境变量配置

项目根目录的 `.env` 文件包含以下关键配置：

```bash
# 数据库配置
DB_HOST=localhost
DB_PORT=5432
DB_NAME=imagentx
DB_USER=postgres
DB_PASSWORD=postgres

# 服务端口
SERVER_PORT=8088
FRONTEND_URL=http://localhost:3000
BACKEND_URL=http://localhost:8088

# 默认用户
IMAGENTX_ADMIN_EMAIL=admin@imagentx.ai
IMAGENTX_ADMIN_PASSWORD=admin123
```

### 数据库配置

- **数据库类型**：PostgreSQL 15
- **数据库名**：imagentx
- **用户名**：postgres
- **密码**：postgres
- **端口**：5432

## 🧪 API测试

### 健康检查
```bash
curl http://localhost:8088/api/health
```

### 用户登录
```bash
curl -X POST http://localhost:8088/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"admin@imagentx.ai","password":"admin123"}'
```

### 创建Agent
```bash
# 先获取token
TOKEN="your_token_here"

curl -X POST http://localhost:8088/api/agents \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "测试AI助手",
    "description": "一个智能对话助手",
    "systemPrompt": "你是一个 helpful AI assistant",
    "modelId": "gpt-4"
  }'
```

## 🔍 常见问题解决

### 1. Docker网络问题
**问题**：无法从Docker Hub拉取镜像
**解决**：使用本地启动脚本绕过Docker
```bash
./start_without_docker.sh
```

### 2. Java环境配置
**问题**：JAVA_HOME未正确设置
**解决**：手动设置JAVA_HOME环境变量
```bash
export JAVA_HOME=/opt/homebrew/Cellar/openjdk/24.0.2/libexec/openjdk.jdk/Contents/Home
```

### 3. 前端依赖冲突
**问题**：date-fns版本冲突
**解决**：使用--legacy-peer-deps安装
```bash
npm install --legacy-peer-deps
```

### 4. 数据库连接问题
**问题**：PostgreSQL服务未启动
**解决**：启动PostgreSQL服务
```bash
brew services start postgresql@15
```

### 5. 端口占用问题
**问题**：端口被占用
**解决**：检查并释放端口
```bash
lsof -i :8088
lsof -i :3000
kill -9 <PID>
```

## 📊 服务监控

### 检查服务状态
```bash
# 检查后端服务
curl http://localhost:8088/api/health

# 检查前端服务
curl http://localhost:3000

# 检查数据库连接
psql -h localhost -U postgres -d imagentx -c "SELECT 1;"
```

### 查看日志
```bash
# 后端日志
tail -f ImagentX/logs/agent-x.log

# 前端日志（在终端中查看）
```

## 🎉 访问地址

- **前端应用**：http://localhost:3000
- **后端API**：http://localhost:8088/api
- **API文档**：http://localhost:8088/swagger-ui.html
- **健康检查**：http://localhost:8088/api/health

## 🔐 默认账号

- **管理员账号**：admin@imagentx.ai / admin123
- **测试账号**：test@imagentx.ai / test123

## 📝 开发建议

1. **数据库配置**：建议配置PostgreSQL数据库以获得完整功能
2. **API测试**：使用Postman或curl测试API功能
3. **前端开发**：支持热重载，修改代码后自动刷新
4. **日志监控**：定期检查日志文件以排查问题

## 🚨 注意事项

1. 确保PostgreSQL服务正常运行
2. 检查防火墙设置，确保端口8088和3000可访问
3. 定期备份数据库数据
4. 生产环境部署前请修改默认密码

---

**项目启动完成！** 🎉
现在您可以访问 http://localhost:3000 开始使用Imagent X平台。
