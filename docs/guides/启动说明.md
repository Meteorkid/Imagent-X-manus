# ImagentX 项目启动说明

## 🎯 当前状态

✅ **已成功启动的服务：**
- PostgreSQL 数据库 (端口 5432)
- RabbitMQ 消息队列 (端口 5672, 15672)
- 前端服务 (端口 3000)

❌ **未启动的服务：**
- 后端API服务 (端口 8088) - 由于向量存储配置问题

## 🌐 访问地址

- **前端界面**: http://localhost:3000
- **RabbitMQ管理界面**: http://localhost:15672 (用户名/密码: guest/guest)
- **PostgreSQL数据库**: localhost:5432 (用户名/密码: postgres/postgres)

## 🔧 问题分析

后端服务启动失败的主要原因是：
1. **向量存储依赖**: 项目依赖pgvector扩展，但当前PostgreSQL镜像不支持
2. **数据库用户配置**: 代码中硬编码了`imagentx_user`用户，但数据库中使用的是`postgres`用户
3. **配置加载问题**: 配置文件修改后没有正确生效

## 🚀 解决方案

### 方案1: 使用Docker镜像（推荐）
```bash
# 停止当前服务
docker-compose -f docker-compose-simple.yml down

# 使用支持pgvector的镜像
docker pull pgvector/pgvector:pg15

# 修改docker-compose-simple.yml中的镜像
# 将 postgres:15-alpine 改为 pgvector/pgvector:pg15

# 重新启动
docker-compose -f docker-compose-simple.yml up -d
```

### 方案2: 手动安装pgvector扩展
```bash
# 进入PostgreSQL容器
docker exec -it imagentx-postgres bash

# 安装pgvector扩展
apt-get update && apt-get install -y postgresql-15-pgvector

# 重启PostgreSQL服务
```

### 方案3: 使用H2内存数据库（开发测试）
```bash
# 修改后端配置使用H2数据库
# 在application.yml中设置：
spring:
  datasource:
    driver-class-name: org.h2.Driver
    url: jdbc:h2:mem:testdb
    username: sa
    password: password
```

## 📋 快速启动命令

```bash
# 1. 启动基础服务
docker-compose -f docker-compose-simple.yml up -d

# 2. 启动前端服务
cd apps/frontend && npm run dev

# 3. 启动后端服务（需要先解决向量存储问题）
cd apps/backend && ./mvnw spring-boot:run
```

## 🔍 故障排除

### 检查服务状态
```bash
./scripts/core/status.sh --ports
```

### 查看日志
```bash
# 后端日志
tail -f apps/backend/logs/agent-x.log

# Docker容器日志
docker logs imagentx-postgres
docker logs imagentx-rabbitmq
```

### 重启服务
```bash
# 重启所有服务
./scripts/core/stop.sh --all
./scripts/core/start.sh --local
```

## 📞 技术支持

如果遇到问题，请检查：
1. Docker容器状态
2. 数据库连接
3. 端口占用情况
4. 日志文件

更多信息请参考项目文档。
