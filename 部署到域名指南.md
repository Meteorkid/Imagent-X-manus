# ImagentX éƒ¨ç½²åˆ°åŸŸåæŒ‡å—

## ğŸ¯ æ¦‚è¿°

æœ¬æŒ‡å—å°†å¸®åŠ©æ‚¨å°†ImagentXé¡¹ç›®éƒ¨ç½²åˆ°åŸŸå `imagentx.top`ï¼ŒåŒ…æ‹¬å®Œæ•´çš„ç”Ÿäº§ç¯å¢ƒé…ç½®ã€SSLè¯ä¹¦ç®¡ç†å’Œè‡ªåŠ¨åŒ–éƒ¨ç½²ã€‚

## ğŸ“‹ å‰ç½®è¦æ±‚

### æœåŠ¡å™¨è¦æ±‚
- **æ“ä½œç³»ç»Ÿ**: Ubuntu 20.04+ / CentOS 8+ / macOS
- **å†…å­˜**: æœ€å°‘ 4GB RAMï¼ˆæ¨è 8GB+ï¼‰
- **å­˜å‚¨**: æœ€å°‘ 20GB å¯ç”¨ç©ºé—´
- **ç½‘ç»œ**: å…¬ç½‘IPï¼Œ80å’Œ443ç«¯å£å¼€æ”¾

### è½¯ä»¶è¦æ±‚
- **Docker**: 20.10+
- **Docker Compose**: 2.0+
- **Git**: æœ€æ–°ç‰ˆæœ¬

### åŸŸåé…ç½®
- åŸŸå `imagentx.top` å·²è´­ä¹°
- DNSè§£æå·²é…ç½®åˆ°æœåŠ¡å™¨IP
- æ”¯æŒAè®°å½•å’ŒCNAMEè®°å½•

## ğŸš€ å¿«é€Ÿéƒ¨ç½²

### 1. å‡†å¤‡ç¯å¢ƒ

```bash
# å…‹éš†é¡¹ç›®
git clone <your-repo-url>
cd ImagentX-master

# å®‰è£…Dockerï¼ˆå¦‚æœæœªå®‰è£…ï¼‰
curl -fsSL https://get.docker.com | sh
sudo usermod -aG docker $USER

# å®‰è£…Docker Compose
sudo curl -L "https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
sudo chmod +x /usr/local/bin/docker-compose
```

### 2. é…ç½®ç¯å¢ƒå˜é‡

```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp env.production.template .env.production

# ç¼–è¾‘é…ç½®æ–‡ä»¶
nano .env.production
```

**é‡è¦é…ç½®é¡¹ï¼š**
```bash
# æ•°æ®åº“é…ç½®
DB_USER=imagentx_user
DB_PASSWORD=your_secure_password_here  # æ›´æ”¹æ­¤å¯†ç 
DB_NAME=imagentx

# JWTå¯†é’¥ï¼ˆå¿…é¡»æ›´æ”¹ï¼‰
JWT_SECRET=your_very_secure_jwt_secret_key_here_change_this_in_production

# ç®¡ç†å‘˜è´¦æˆ·
IMAGENTX_ADMIN_EMAIL=admin@imagentx.top
IMAGENTX_ADMIN_PASSWORD=your_admin_password_here  # æ›´æ”¹æ­¤å¯†ç 

# SSLè¯ä¹¦é‚®ç®±
SSL_EMAIL=admin@imagentx.top
```

### 3. åˆå§‹åŒ–éƒ¨ç½²

```bash
# ç»™éƒ¨ç½²è„šæœ¬æ‰§è¡Œæƒé™
chmod +x deploy-production.sh

# åˆå§‹åŒ–éƒ¨ç½²
./deploy-production.sh --init
```

### 4. éƒ¨ç½²æœåŠ¡

```bash
# éƒ¨ç½²æ‰€æœ‰æœåŠ¡
./deploy-production.sh --deploy
```

### 5. éªŒè¯éƒ¨ç½²

```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
./deploy-production.sh --status

# è®¿é—®ç½‘ç«™
# å‰ç«¯: https://imagentx.top
# åç«¯API: https://imagentx.top/api
# å¥åº·æ£€æŸ¥: https://imagentx.top/health
```

## ğŸ”§ è¯¦ç»†é…ç½®

### åŸŸåDNSé…ç½®

åœ¨æ‚¨çš„åŸŸåç®¡ç†é¢æ¿ä¸­é…ç½®ä»¥ä¸‹DNSè®°å½•ï¼š

```
ç±»å‹    åç§°    å€¼
A       @       æ‚¨çš„æœåŠ¡å™¨IP
A       www     æ‚¨çš„æœåŠ¡å™¨IP
CNAME   api     æ‚¨çš„æœåŠ¡å™¨IP
```

### SSLè¯ä¹¦é…ç½®

é¡¹ç›®ä½¿ç”¨Let's Encryptè‡ªåŠ¨è·å–SSLè¯ä¹¦ï¼š

1. **è‡ªåŠ¨è·å–**: é¦–æ¬¡éƒ¨ç½²æ—¶ä¼šè‡ªåŠ¨è·å–è¯ä¹¦
2. **è‡ªåŠ¨ç»­æœŸ**: è¯ä¹¦ä¼šåœ¨åˆ°æœŸå‰è‡ªåŠ¨ç»­æœŸ
3. **æ‰‹åŠ¨æ›´æ–°**: å¦‚éœ€æ‰‹åŠ¨æ›´æ–°ï¼Œè¿è¡Œï¼š
   ```bash
   ./deploy-production.sh --ssl
   ```

### æ•°æ®åº“é…ç½®

PostgreSQLæ•°æ®åº“é…ç½®ï¼š
- **ç«¯å£**: 5432ï¼ˆå†…éƒ¨ï¼‰
- **æ•°æ®åº“å**: imagentx
- **ç”¨æˆ·å**: imagentx_user
- **å¯†ç **: åœ¨.env.productionä¸­é…ç½®

### æ¶ˆæ¯é˜Ÿåˆ—é…ç½®

RabbitMQé…ç½®ï¼š
- **ç®¡ç†ç•Œé¢**: https://imagentx.top:15672
- **ç”¨æˆ·å**: imagentx_user
- **å¯†ç **: åœ¨.env.productionä¸­é…ç½®

## ğŸ“Š ç›‘æ§å’Œç»´æŠ¤

### æŸ¥çœ‹æ—¥å¿—

```bash
# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡æ—¥å¿—
./deploy-production.sh --logs

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—
docker-compose -f docker-compose-production.yml logs -f imagentx-backend-prod
```

### å¤‡ä»½æ•°æ®

```bash
# åˆ›å»ºå®Œæ•´å¤‡ä»½
./deploy-production.sh --backup
```

### æ›´æ–°æœåŠ¡

```bash
# æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬
./deploy-production.sh --update
```

### é‡å¯æœåŠ¡

```bash
# é‡å¯æ‰€æœ‰æœåŠ¡
./deploy-production.sh --restart

# é‡å¯ç‰¹å®šæœåŠ¡
docker-compose -f docker-compose-production.yml restart imagentx-backend-prod
```

## ğŸ”’ å®‰å…¨é…ç½®

### é˜²ç«å¢™é…ç½®

```bash
# åªå¼€æ”¾å¿…è¦ç«¯å£
sudo ufw allow 22/tcp    # SSH
sudo ufw allow 80/tcp    # HTTP
sudo ufw allow 443/tcp   # HTTPS
sudo ufw enable
```

### å®‰å…¨æœ€ä½³å®è·µ

1. **æ›´æ”¹é»˜è®¤å¯†ç **: ç¡®ä¿æ›´æ”¹æ‰€æœ‰é»˜è®¤å¯†ç 
2. **å®šæœŸæ›´æ–°**: å®šæœŸæ›´æ–°ç³»ç»Ÿå’ŒDockeré•œåƒ
3. **ç›‘æ§æ—¥å¿—**: å®šæœŸæ£€æŸ¥è®¿é—®æ—¥å¿—
4. **å¤‡ä»½ç­–ç•¥**: è®¾ç½®è‡ªåŠ¨å¤‡ä»½è®¡åˆ’
5. **SSLé…ç½®**: ä½¿ç”¨å¼ºåŠ å¯†å¥—ä»¶

## ğŸš¨ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **SSLè¯ä¹¦è·å–å¤±è´¥**
   ```bash
   # æ£€æŸ¥åŸŸåè§£æ
   nslookup imagentx.top
   
   # æ£€æŸ¥80ç«¯å£æ˜¯å¦å¼€æ”¾
   sudo netstat -tlnp | grep :80
   ```

2. **æœåŠ¡å¯åŠ¨å¤±è´¥**
   ```bash
   # æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
   docker-compose -f docker-compose-production.yml logs
   
   # æ£€æŸ¥ç«¯å£å ç”¨
   sudo netstat -tlnp | grep -E ":(80|443|3000|8088)"
   ```

3. **æ•°æ®åº“è¿æ¥å¤±è´¥**
   ```bash
   # æ£€æŸ¥æ•°æ®åº“çŠ¶æ€
   docker exec imagentx-postgres-prod psql -U imagentx_user -d imagentx -c "SELECT version();"
   ```

### æ€§èƒ½ä¼˜åŒ–

1. **å¯ç”¨Gzipå‹ç¼©**: å·²åœ¨Nginxé…ç½®ä¸­å¯ç”¨
2. **é™æ€èµ„æºç¼“å­˜**: å·²é…ç½®é•¿æœŸç¼“å­˜
3. **æ•°æ®åº“ä¼˜åŒ–**: æ ¹æ®è®¿é—®é‡è°ƒæ•´è¿æ¥æ± 
4. **CDNé…ç½®**: å¯é…ç½®CDNåŠ é€Ÿé™æ€èµ„æº

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼š

1. æ£€æŸ¥æ—¥å¿—æ–‡ä»¶
2. éªŒè¯ç½‘ç»œè¿æ¥
3. ç¡®è®¤DNSé…ç½®
4. æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
5. æŸ¥çœ‹Dockerå®¹å™¨çŠ¶æ€

### æœ‰ç”¨çš„å‘½ä»¤

```bash
# æŸ¥çœ‹æ‰€æœ‰å®¹å™¨çŠ¶æ€
docker ps -a

# æŸ¥çœ‹ç³»ç»Ÿèµ„æºä½¿ç”¨
docker stats

# æ¸…ç†æœªä½¿ç”¨çš„èµ„æº
docker system prune -a

# æŸ¥çœ‹ç£ç›˜ä½¿ç”¨
df -h

# æŸ¥çœ‹å†…å­˜ä½¿ç”¨
free -h
```

## ğŸ‰ éƒ¨ç½²å®Œæˆ

éƒ¨ç½²å®Œæˆåï¼Œæ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹åœ°å€è®¿é—®ï¼š

- **ä¸»ç«™**: https://imagentx.top
- **APIæ–‡æ¡£**: https://imagentx.top/api
- **ç®¡ç†ç•Œé¢**: https://imagentx.top/admin
- **å¥åº·æ£€æŸ¥**: https://imagentx.top/health

æ­å–œï¼æ‚¨çš„ImagentXé¡¹ç›®å·²æˆåŠŸéƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€‚
